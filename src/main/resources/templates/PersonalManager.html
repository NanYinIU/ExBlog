<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>blog</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
        <script src="/assets/js/jquery.min.js"></script>
        <script src="/assets/js/template-web.js"></script>
		<link rel="stylesheet" href="/assets/css/main.css" />
        <link rel="stylesheet" href="/assets/css/dianzan/style.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
	</head>
	<body>
<!--不登录不让进去-->
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="#">Social Blog</a></h1>
						<nav class="links">
							<ul>
								<li><a href="#">博客专栏</a></li>
								<li><a href="#">博文排行</a></li>
								<li><a href="#">博客砖家</a></li>
								<li><a href="#">我的博客</a></li>
							</ul>
						</nav>
						<nav class="main">
							<ul>
								<li class="search">
									<a class="fa-search" href="#search">Search</a>
									<form id="sForm" method="post" action="#">
										<input type="text" name="search" placeholder="Search" />
									</form>
								</li>
								<li class="menu">
									<a class="fa-bars" href="#menu">Menu</a>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Menu -->
					<section id="menu">

						<!-- Search -->
							<section>
								<form class="sForm2" method="get" action="#">
									<input type="text" name="search" id="search" placeholder="Search" />
								</form>
							</section>
						<!-- Links -->
							<section>
								<ul class="links">
									<li>
										<a href="#">
											<h3>博客专栏</h3>
											<p>Feugiat tempus veroeros dolor</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>博文排行</h3>
											<p>Sed vitae justo condimentum</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>博客砖家</h3>
											<p>Phasellus sed ultricies mi congue</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>我的博客</h3>
											<p>Porta lectus amet ultricies</p>
										</a>
									</li>
								</ul>
							</section>
						<!-- Actions -->
							<section>
								<ul class="actions vertical">
									<a th:if="${session.user == null}"><li><a href="/user/login" class="button big fit">登录</a></li></a>
									<a th:if="${session.user != null}"><li><a href="/user/logout" class="button big fit">更换账号</a></li></a>
								</ul>
							</section>

					</section>


				<!-- Main -->
				<!--post-->
					<div id="main">


							<!-- Post -->
							<article class="post">
								<header>
									<ul>
									<div class="title" th:each="page,pageStat :${pageInfo.list}">

                                        <style>
                                            li {list-style-type:none;}
                                        </style>

											<h3>
                                                <li><a href="#" th:text="${page.title}"></a></li>
                                                <!--<time class="published" datetime="2015-11-01" th:text="${page.create_time}"></time>-->
                                                <a class="button" th:id="'post_delete'+${page.id}" th:value="${page.id}" onclick="delete_now(this.id)">删除</a>
                                                <a class="button" id="post_update">修改</a>
                                                <a class="button" id="post_check">查看</a>
                                            </h3>


                                        <form>
                                            <input type="hidden" th:id="'page_id'+${page.id}" th:value="${page.id}"/>
                                        </form>

									</div>
                                    </ul>
								</header>

                                <script>
                                    function delete_now(obj) {
                                        alert(obj);
                                        var A = obj.split("post_delete");
                                        alert(A);
                                        var paperId = A[1];
                                        var del_url = "/paper/delect/"+paperId;
                                        $.ajax({
                                            type:"post",
                                            dataType:"json",
                                            url:del_url,
                                            success:function (data) {
                                                if(data=='1'){
                                                    alert("删除成功！");
                                                    location.reload();
                                                }else
                                                {
                                                    alert("删除失败")
                                                }
                                            }
                                        })
                                    }
                                </script>

							</article>



                            <!-- Pagination -->
                            <ul class="actions pagination">
                                <li><a th:href="@{/personalPage/}+${session.user}+'/'+${pageInfo.prePage}" class="button big previous">Previous Page</a></li>
                                <li><a th:href="@{/personalPage/}+${session.user}+'/'+${pageInfo.nextPage}" class="button big next">Next Page</a></li>
                            </ul>



					</div>

				<!-- Sidebar -->
					<section id="sidebar">

						 <!--Intro-->
                        <script type="text/html" id="head">
							<section id="intro">

                                <a href="#" class="logo"><img src="{{head}}" alt="" /></a>
								<header>
                                    <h3><a>{{login_name}}</a></h3>
                                    <h3>关注数量：    文章数量：</h3>
								</header>
							</section>
                        </script>

                        <script type="text/javascript">
                            var h ='';
                            $(document).ready(function () {
                                url = '/userMes/'+userName;
                                $.ajax( {
                                    type : "post",
                                    dataType:"json",
                                    url : url,
                                    timeout : 20000,
                                    cache : false,
                                    success : function(data) {
                                        h = template('head', data);
                                        document.getElementById('content5').innerHTML = h;
                                    }

                                });
                            })
                        </script>
                        <div class="span12">
                            <div id="content5"></div>
                        </div>
						<!-- Mini Posts 主题 -->

						<script type="text/html" id="mini_post">
                            <section>
                                   <article>
                                        <h3><a href="#">{{title}}</a>  ({{count}})</h3>
                                   </article>
                            </section>
						</script>

                        <form>
                            <input id="userName" name="userName" type="hidden" th:value="${session.user}"/>
                        </form>

						<script type="text/javascript" >
                            var html2 ='';
                            var userName ;

                             userName =   document.getElementById("userName").value;
//                            var userName = form1.userName.value;
//                            alert(userName);
                            $(document).ready(function () {
                                url = '/column/PersonalColumn/'+userName;
                                $.ajax( {
                                    type : "post",
                                    dataType:"json",
                                    url : url,
                                    timeout : 20000,
                                    cache : false,
                                    success : function(data) {
                                        var i;
                                        for(i in data.columnList){
                                            html2 = template('mini_post', data.columnList[i])+html2;
                                        }
                                        document.getElementById('content').innerHTML = html2;
                                    }

                                });
                            })
						</script>

						<div class="span12">
                            <h3><a class="icon fa-tags"> </a>已有文章分类：</h3>
							<div id="content"></div>
						</div>

						<!-- postlist  -->
						<script type="text/html" id="post_list">

							<section>
										<article>
											<header>
											</header>
                                            <h3><a href="#">{{tag_name}}</a>   ({{count}})</h3>
										</article>
							</section>
						</script>


						<script type="text/javascript">
                            var html3 ='';
                            $(document).ready(function () {
                                url = '/tag/PersonalTag/'+userName;
                                $.ajax( {
                                    type : "post",
                                    dataType:"json",
                                    url : url,
                                    timeout : 20000,
                                    cache : false,
                                    success : function(data) {
                                        var i;
                                        var j;
                                        for(i in data.tagList){
                                            html3 = template('post_list', data.tagList[i])+html3;
                                        }
                                        document.getElementById('content4').innerHTML = html3;
                                    }

                                });
                            })
						</script>

						<div class="span12">
							<h3><a class="icon fa-tags"> </a>已有标签分类：</h3>
							<div id="content4"></div>
						</div>

						<!-- About -->
							<section class="blurb">
								<h2>关于</h2>
								<p>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed mattis nunc id lorem euismod amet placerat. Vivamus porttitor magna enim, ac accumsan tortor cursus at phasellus sed ultricies.</p>
								<ul class="actions">
									<li><a href="#" class="button">了解更多</a></li>
                                    <li><a th:text="${username}">..</a></li>
								</ul>
							</section>

						<!-- Footer -->
							<section id="footer">
								<p class="copyright">&copy; Untitled..</p>
							</section>

					</section>

			</div>

		<!-- Scripts -->
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="/assets/js/main.js"></script>

	</body>
</html>